/*! dhx 2015-06-06 */
$dhx.ui.crud.simple.View={layout:null,menu:[],menu_grid:[],ribbon:[],tab:null,grid:null,status_bar:null,task_bar:null,task_bar:null,window:[],openedCRUD:[],strWindowID:"$dhx.ui.crud.simple.View.generic.window.",status_bar:function(a,b){this.template="<div class='status_info' id='status_info_"+a+"'>"+$dhx.ui.language.Initializing+" "+$dhx.ui.crud.controller[a].appName+"</div><div class='expiration_info' id='expiration_info_"+a+"' title='"+$dhx.ui.language.time_remaining_for_token_expiration+"'></div><div class='user_info' id='user_info_"+a+"'><img id='user_info_status_"+a+"' src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABvUlEQVR4XpWRy0tbQRjFz9yH3hgtruzGRqRx47aoaxvBdboo7qTtrst2WRAfDcZo/wAR/BPiRroouHHZFqmCT9DEV0uiYmjD9OZO5k5nRiPk0Rvyg8vhG74535nvEtSQTC6mXdeNozlwHGetzmB6es6fmvpAJAhCCIHZ2QQs1KMvPx5+jSByX1e1klYi/2E2ds5K2D7IaoOZmY93kSWiGapH9oqB0beiZ+iVkOjaajUyZVW7qd7BYLQXBiEwTAMED406cgU71AlWoo0N/roeTNOEadnwhY9C4Tc8z6uaSAv5/yfwfFNOd+QlIs0YyrwNjLGGT5E7UW8XVQa3lKM9bMF2OuG0AcwtAoTgHbaQjfVhEpC6ggqxnqdZqyae/mp50XWJJ2vbIB1hnI1HEVnfQzn3E3gz1q/+pc85F0FknkcEZ54u2HVOK6dFfU5SqU9pSmkcAUxu6tg6hfmoG+WbPC5eDkEzv5B4f3xyxL9sfBaHR/tC6daPb/f6XamapCcqWP6XVl5y9blFCJZOMscIOSGcnmdgWTaub65gGIbUPGxZKwRj8M0SLiZGHnagIMlUQqAJz3Y3ET3fRwOW/wEKrjnBHaxMrAAAAABJRU5ErkJggg==' /> <span>"+$dhx.ui.language.Notauthorizedyet+"</span></div><div class='data_transfer_info' id='data_transfer_info_"+a+"'>"+$dhx.ui.language.no_data_transferred+"</div><div class='errors_info' id='errors_info_"+a+"'>"+$dhx.ui.language.no_errors+"</div>",this._setStatus=function(b){try{document.getElementById("status_info_"+a).innerHTML=b}catch(c){console.log(c.stack)}},this._setStatusError=function(b){try{document.getElementById("errors_info_"+a).innerHTML=b}catch(c){console.log(c.stack)}},this._setStatusDataTransfer=function(c,d){try{d?(document.getElementById("data_transfer_info_"+a).innerHTML=c,document.getElementById("data_transfer_info_"+a).style.backgroundImage="url("+b+"network.gif)"):(document.getElementById("data_transfer_info_"+a).innerHTML=c,document.getElementById("data_transfer_info_"+a).style.backgroundImage="url("+b+"network-accept.png)")}catch(e){console.log(e.stack)}},this._setStatusSocket=function(c,d){try{dhtmlx.message({text:c}),document.getElementById("socket_info_"+a).innerHTML="socket: "+c,document.getElementById("socket_info_"+a).style.backgroundImage="url("+b+"socket.gif)",d&&(document.getElementById("socket_info_"+a).style.backgroundImage="url("+b+"socket_disconnected.png)")}catch(e){console.log(e.stack)}},this._setStatusUser=function(c,d){try{"undefined"==typeof d&&(d=!0),document.getElementById("user_info_"+a).getElementsByTagName("span")[0].innerHTML=c,d?document.getElementById("user_info_status_"+a).src=""+b+"online.png":(document.getElementById("user_info_status_"+a).src=""+b+"offline.png",dhtmlx.message({type:"error",text:c}))}catch(e){}}},helpers:{disableButtonActions:function(a){var b=$dhx.ui.crud.controller[a].view;try{if(b.menu[a].setItemDisabled("update"),b.menu[a].setItemDisabled("open"),b.menu_grid[a].setItemDisabled("update"),b.menu_grid[a].setItemDisabled("open"),b.menu[a].setItemDisabled("delete"),b.menu_grid[a].setItemDisabled("delete"),!b.ribbon[a])return;b.ribbon[a].disable("delete"),b.ribbon[a].disable("update"),b.ribbon[a].disable("previous"),b.ribbon[a].disable("next"),b.ribbon[a].disable("open")}catch(c){}},enableButtonActions:function(a){var b=$dhx.ui.crud.controller[a].view;try{if(b.menu[a].setItemEnabled("update"),b.menu[a].setItemEnabled("open"),b.menu_grid[a].setItemEnabled("update"),b.menu_grid[a].setItemEnabled("open"),b.menu[a].setItemEnabled("delete"),b.menu_grid[a].setItemEnabled("delete"),!b.ribbon[a])return;b.ribbon[a].enable("delete"),b.ribbon[a].enable("update"),b.ribbon[a].enable("previous"),b.ribbon[a].enable("next"),b.ribbon[a].enable("open")}catch(c){}},viewRecord:function(a,b){var c=$dhx.ui.crud.controller[b].view,d=b.split("crud.simple.")[1];d=d.split("_")[0];var e=$dhx.ui.data.model.db[$dhx.ui.crud.controller[b].database].schema[d],f={wrapper:c.tab,record_id:a,table:d,db:$dhx.ui.crud.controller[b].database};c.ribbon[b]||(f.is_generic=!0),$dhx.ui.crud.simple.View.Record.render(f,e)}},destroy:function(a,b){try{var c=$dhx.ui.crud.controller[a].view,d=a.split("crud.simple.")[1];d=d.split("_app")[0],b=$dhx.ui.data.model.db[$dhx.ui.crud.controller[a].database].schema[d],b.unsync.grid({component:c.grid,component_id:"main_grid_"+a,onSuccess:function(){},onFail:function(){alert("could not unsync grid")}});try{}catch(e){}try{c.layout.cells("a").attachHTMLString("xx")}catch(e){}}catch(e){console.log(e.stack)}},_window:function(a){var b=$dhx.ui.crud.controller[a].view,c={id:b.strWindowID+"."+a,left:$dhx.ui.crud.simple.View.settings.app_generic.window.left,top:$dhx.ui.crud.simple.View.settings.app_generic.window.top,width:$dhx.ui.crud.simple.View.settings.app_generic.window.width,height:$dhx.ui.crud.simple.View.settings.app_generic.window.height};b.window[a]=new $dhx.ui.window(c),b.window[a].attachEvent("onClose",function(b){return $dhx.ui.crud.controller[a].destroy(),!0}),b.window[a].setText($dhx.ui.crud.controller[a].collection+" management")},_layout:function(a){var b=$dhx.ui.crud.controller[a].view;$dhx.ui.crud.controller[a].configuration.wrapper?($dhx.ui.crud.simple.View.settings.layout.parent=$dhx.ui.crud.controller[a].configuration.wrapper,b.layout=new dhtmlXLayoutObject($dhx.ui.crud.simple.View.settings.layout)):b.layout=b.window[a].attachLayout($dhx.ui.crud.simple.View.settings.layout),b.layout.cells("a").hideHeader(),b.task_bar=b.layout.attachStatusBar()},_menu:function(a,b,c,d){var e=$dhx.ui.crud.controller[a].view;"undefined"==typeof $dhx.ui.crud.controller[a].configuration.wrapper?e.menu[a]=e.window[a].attachMenu($dhx.ui.crud.simple.View.settings.menu):e.menu[a]=$dhx.ui.crud.controller[a].configuration.wrapper.attachMenu($dhx.ui.crud.simple.View.settings.menu),e.menu[a].attachEvent("onClick",function(b){if("print"==b);else if("insert"==b)$dhx.ui.crud.simple.View.FormWindow.render({database:$dhx.ui.crud.controller[a].database,table:$dhx.ui.crud.controller[a].collection,schema:d});else if("update"==b)e.grid.getSelectedRowId()&&$dhx.ui.crud.simple.View.FormWindow.render({record_id:e.grid.getSelectedRowId(),database:$dhx.ui.crud.controller[a].database,table:$dhx.ui.crud.controller[a].collection,schema:d});else if("find"==b)$dhx.ui.crud.simple.View.Search.render({database:$dhx.ui.crud.controller[a].database,table:$dhx.ui.crud.controller[a].collection,schema:d,appId:a});else if("open"==b)e.grid.getSelectedRowId()&&e.helpers.viewRecord(e.grid.getSelectedRowId(),a,d);else if("pdf"==b)e.grid.dhxPDF($dhx.ui.cdn_address+"dhx/ui/bin/2pdf/generate.php","color",!0,!1,!1,!1,a);else if("dhx_terrace"==b)$dhx.ui.setUserSkin("dhx_terrace");else if("dhx_skyblue"==b)$dhx.ui.setUserSkin("dhx_skyblue");else if("dhx_web"==b)$dhx.ui.setUserSkin("dhx_web");else if("web-green"==b)$dhx.ui.setUserSkin("web-green");else if("light-green"==b)$dhx.ui.setUserSkin("light-green");else if("clouds"==b)$dhx.ui.setUserSkin("clouds");else if("pink-yellow"==b)$dhx.ui.setUserSkin("pink-yellow");else if("terrace-blue"==b)$dhx.ui.setUserSkin("terrace-blue");else if("portuguese"==b)$dhx.ui.i18n.setUserIdiom("pt-br");else if("english"==b)$dhx.ui.i18n.setUserIdiom("en-us");else if(b.indexOf("table.")>-1){var c=b.split(".")[1];e.openedCRUD[c]=new $dhx.ui.crud.simple({database:$dhx.ui.crud.controller[a].database,collection:c,base_path:$dhx.ui.crud.simple.View.settings.base_path})}})},_tab:function(a,b){var c=$dhx.ui.crud.controller[a].view;c.tab=c.layout.cells("a").attachTabbar($dhx.ui.crud.simple.View.settings.tab),c.status_bar=c.tab.cells("records").attachStatusBar(),c.status_bar.setText(b.template),c.tab.attachEvent("onTabClose",function(a){try{}catch(b){}return!0})},_menu_grid:function(a,b,c,d){var e=$dhx.ui.crud.controller[a].view;e.menu_grid[a]=new dhtmlXMenuObject,e.menu_grid[a].setSkin($dhx.ui.skin),e.menu_grid[a].setIconsPath($dhx.ui.crud.simple.View.settings.menu_grid.icons_path),e.menu_grid[a].renderAsContextMenu(),e.menu_grid[a].loadStruct($dhx.ui.crud.simple.View.settings.menu_grid),e.menu_grid[a].attachEvent("onClick",function(b){if("print"==b);else if("insert"==b)$dhx.ui.crud.simple.View.FormWindow.render({database:$dhx.ui.crud.controller[a].database,table:$dhx.ui.crud.controller[a].collection,schema:d});else if("update"==b)e.grid.getSelectedRowId()&&$dhx.ui.crud.simple.View.FormWindow.render({record_id:e.grid.getSelectedRowId(),database:$dhx.ui.crud.controller[a].database,table:$dhx.ui.crud.controller[a].collection,schema:d});else if("find"==b)$dhx.ui.crud.simple.View.Search.render({database:$dhx.ui.crud.controller[a].database,table:$dhx.ui.crud.controller[a].collection,schema:d,appId:a});else if("open"==b)e.grid.getSelectedRowId()&&e.helpers.viewRecord(e.grid.getSelectedRowId(),a,d);else if("pdf"==b)e.grid.dhxPDF($dhx.ui.cdn_address+"dhx/ui/bin/2pdf/generate.php","color",!0,!1,!1,!1,a);else if("dhx_terrace"==b)$dhx.ui.setUserSkin("dhx_terrace");else if("dhx_skyblue"==b)$dhx.ui.setUserSkin("dhx_skyblue");else if("dhx_web"==b)$dhx.ui.setUserSkin("dhx_web");else if("web-green"==b)$dhx.ui.setUserSkin("web-green");else if("light-green"==b)$dhx.ui.setUserSkin("light-green");else if("clouds"==b)$dhx.ui.setUserSkin("clouds");else if("pink-yellow"==b)$dhx.ui.setUserSkin("pink-yellow");else if("terrace-blue"==b)$dhx.ui.setUserSkin("terrace-blue");else if("portuguese"==b)$dhx.ui.i18n.setUserIdiom("pt-br");else if("english"==b)$dhx.ui.i18n.setUserIdiom("en-us");else if(b.indexOf("table.")>-1){var c=b.split(".")[1];e.openedCRUD[c]=new $dhx.ui.crud.simple({database:$dhx.ui.crud.controller[a].database,collection:c,base_path:$dhx.ui.crud.simple.View.settings.base_path})}})},_grid:function(a,b,c){var d=$dhx.ui.crud.controller[a].view;d.grid=d.tab.cells("records").attachGrid(),d.grid.enableContextMenu(d.menu_grid[a]),d.grid.saveOnEdit=!0,c.sync.grid({component:d.grid,component_id:"main_grid_"+a,auto_configure:!0,onSuccess:function(){},onFail:function(){b._setStatusError($dhx.ui.language.could_not_sync_grid)}})},_ribbon:function(a,b,c){var d=$dhx.ui.crud.controller[a].view;d.ribbon[a]=d.layout.cells("a").attachRibbon($dhx.ui.crud.simple.View.settings.ribbon),d.helpers.disableButtonActions(a),d.ribbon[a].attachEvent("onClick",function(e){if("select"==e)d.grid.clearAll(),c.load(function(b,c,e,f){d.helpers.disableButtonActions(a);var g={rows:[]},h={db:$dhx.ui.crud.controller[a].database,table:$dhx.ui.crud.controller[a].collection},i=$dhx.dataDriver.getTableSchema(h),j=i.primary_key.keyPath,k=$dhx.dataDriver._getColumnsId(h).split(",");b.forEach(function(a,b,c){var d=[];k.forEach(function(b,c,e){d[c]=a.record[b]}),g.rows.push({id:a.record[j],data:d})}),d.grid.parse(g,"json")},function(a,b,c){console.log(c)});else if("add1000"==e){var f=[];$dhx.showDirections("hold on while I do some work .... ");var g=(new Date).getTime();for(i=g;i<g+1e3;i++)f.push({status:1,client_group_id:1,rest_api_alowed_requests_per_day:0,storage_quota:200,company_id:1,title:"Mr",birth_date:null,group_id:1,is_offshore:0,person_id:i,is_client_group:0,rest_api_last_login:null,rest_api_access:0,brazilian_rg:null,password:"",email:i+"@web2solutions.com.br",name:"Pessoa"+i,nationality:null,company_name:null,marital_status:null,date_created:null,occupation:null,sallary:"15000.00",brazilian_inscricao_municipal:null,brazilian_titulo_eleitor:null,web_site_last_login:null,username:i+"@web2solutions.com.br",brazilian_ctps_serie:null,brazilian_ctps:null,brazilian_cpf:null,brazilian_inscricao_estadual:null,time_zone:"America/Sao_Paulo",brazilian_cnpj:null,trading_name:null,notes:null,web_site_access:0,gender:"M",brazilian_oab:null,company_branch_id:1});c.add(f,function(){$dhx.hideDirections()},function(a,c,d){b._setStatusError(d)})}else"gettotal"==e?(b._setStatusDataTransfer($dhx.ui.language.counting_records,!0),c.count(function(a,c,d){b._setStatusDataTransfer($dhx.ui.language.total_records+": "+d,!1)},function(a,c,d){b._setStatusError(d)})):"getquota"==e?(b._setStatusDataTransfer($dhx.ui.language.getting_quota_information,!0),that.model.db._getQuota(function(a,c){a=a/1024/1024/1024,c=c/1024/1024/1024;var d=$dhx.ui.language.used+": "+a.toFixed(5)+"GB. "+$dhx.ui.language.remaining+": "+c.toFixed(2)+"GB";$dhx.notify($dhx.ui.language.Quota_information,d,"icons/db.png"),b._setStatusDataTransfer($dhx.ui.language.used+": "+a.toFixed(5)+"GB. "+$dhx.ui.language.remaining+": "+c.toFixed(2)+"GB",!1)},function(a){b._setStatusDataTransfer(a,!1)})):"first"==e?(b._setStatusDataTransfer($dhx.ui.language.requesting_first_record,!0),c.first(function(a,c,d,e){b._setStatusDataTransfer("ok",!1)},function(a,c,d){b._setStatusError(d)})):"next"==e?(b._setStatusDataTransfer($dhx.ui.language.requesting_next_record,!0),c.next(function(a,c,d,e){b._setStatusDataTransfer("ok",!1)},function(a,c,d){b._setStatusError(d),$dhx.notify("navigation",d,"icons/db.png")})):"previous"==e?(b._setStatusDataTransfer($dhx.ui.language.requesting_previous_record,!0),c.previous(function(a,c,d,e){b._setStatusDataTransfer("ok",!1)},function(a,c,d){b._setStatusError(d),$dhx.notify("navigation",d,"icons/db.png")})):"last"==e?(b._setStatusDataTransfer($dhx.ui.language.requesting_last_record,!0),c.last(function(a,c,d,e){b._setStatusDataTransfer("ok",!1)},function(a,c,d){b._setStatusError(d)})):"gettablesize"==e?(b._setStatusDataTransfer("requesting table size",!0),c.getTableSizeInBytes(function(a,c,d){var d=(d/1024).toFixed(2)+" KB";b._setStatusDataTransfer("table size :"+d,!1)},function(a,c,d){b._setStatusError(d)})):"cleartable"==e?(b._setStatusDataTransfer("deleting all records",!0),c.clearAll(function(a,c){b._setStatusDataTransfer("all records deleted",!1)},function(a,c,d){b._setStatusError(d)})):"insert"==e?$dhx.ui.crud.simple.View.FormWindow.render({database:$dhx.ui.crud.controller[a].database,table:$dhx.ui.crud.controller[a].collection,schema:c}):"update"==e?d.grid.getSelectedRowId()&&$dhx.ui.crud.simple.View.FormWindow.render({record_id:d.grid.getSelectedRowId(),database:$dhx.ui.crud.controller[a].database,table:$dhx.ui.crud.controller[a].collection,schema:c}):"open"==e?d.grid.getSelectedRowId()&&d.helpers.viewRecord(d.grid.getSelectedRowId(),a,c):"pdf"==e?d.grid.toPDFX("codebase/grid-pdf-php/generate.php","color",!0):"find"==e?$dhx.ui.crud.simple.View.Search.render({database:$dhx.ui.crud.controller[a].database,table:$dhx.ui.crud.controller[a].collection,schema:c,appId:a}):"getCursor"==e?(b._setStatusDataTransfer("getting cursor",!0),c.getCursor(function(a,c,d){b._setStatusDataTransfer("cursor got "+a,!1)},function(a,c,d){b._setStatusError(d)})):"delete"==e?d.grid.getSelectedRowId()&&(b._setStatusDataTransfer("deleting record",!0),c.del(d.grid.getSelectedRowId(),function(c,e,f){b._setStatusDataTransfer("record deleted: "+f,!1),d.helpers.disableButtonActions(a)},function(a,c,d){b._setStatusError(d)})):"dropdb"==e&&(b._setStatusDataTransfer("deleting database",!0),that.model.db.drop(function(a,c,d){b._setStatusDataTransfer(a,!1)},function(a,c,d){b._setStatusError(d)}))})},controller:[],render:function(a){var b=a.appId,c=$dhx.ui.crud.controller[b],d=$dhx.ui.data.model.db[a.database].schema[a.collection],e=($dhx.ui.data.model.settings[a.database][a.collection],$dhx.ui.data.model.schema[a.database][a.collection].foreign_keys),f=$dhx.ui.crud.simple.View.strWindowID+b;if($dhx.ui.window_manager.isWindow(f))return c.view.window[b].show(),void c.view.window[b].bringToTop();console.log(f),c=$dhx.ui.crud.controller[b].view,"undefined"==typeof $dhx.ui.crud.controller[b].configuration.wrapper&&c._window(b,g,d),c._layout(b);var g=new c.status_bar(b,$dhx.ui.crud.simple.View.settings.icons_path);c._tab(b,g),c._menu_grid(b,g,e,d),c._grid(b,g,d),c._menu(b,g,e,d),c.tab.tabs("records").setText($dhx.ui.crud.controller[b].collection.toUpperCase()),c._ribbon(b,g,d);var h=0,i=!1;for(var j in e)i||c.menu[b].addNewSibling("edit","fkeys_table",$dhx.ui.language.AnotherRecords,!1),i=!0,c.menu[b].addNewChild("fkeys_table",h,"table."+e[j].table,$dhx.ui.language.EditNameTable(e[j].table),!1,"form.gif"),h+=1;d.attachEvent("onAfterCursorChange",function(c,d){d==a.collection&&($dhx.ui.crud.controller[b].view.helpers.enableButtonActions(b),g._setStatus($dhx.ui.language.selected+": "+c,!1))}),d.attachEvent("onBeforeCursorChange",function(a){}),d.attachEvent("onAfterAdd",function(a,c){$dhx.ui.crud.controller[b].view.helpers.enableButtonActions(b),g._setStatusDataTransfer("added: "+c+" records",!1)}),d.attachEvent("onBeforeAdd",function(){}),g._setStatusDataTransfer($dhx.ui.language.counting_records,!0),d.count(function(a,b,c){g._setStatusDataTransfer("ok",!1),g._setStatus($dhx.ui.language.total_records+": "+c)},function(a,b,c){g._setStatusError("error when counting records: "+c)}),$dhx.hideDirections()}};